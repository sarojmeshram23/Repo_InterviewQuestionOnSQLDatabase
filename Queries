Practical
---------------------------------------------------------
The term "pivot" refers to the process of transforming rows into columns to summarize or aggregate data, 
creating a cross-tabulation report.

(1) SELECT REPLACE('SQL Tutorial', 'SQL', 'HTML');
    Output -> HTML Tutorial

(2)
SELECT 
CASE
    WHEN (A+B<=C) OR (B+C<=A) OR (C+A<=B) THEN 'Not A Triangle'
    WHEN A=B AND B=C AND C=A THEN 'Equilateral'
    WHEN A=B OR B=C OR C=A THEN 'Isosceles'
    WHEN (A<>B and B<>C and C<>A)  THEN 'Scalene'
    
END 
FROM TRIANGLES; 
go

(3)
WITH correct_cte AS 
  ( SELECT AVG(CAST(salary AS DECIMAL(18,6))) 
AS correct_avg FROM employees )
, 
wrong_cte AS 
( SELECT AVG( CAST( COALESCE( NULLIF(REPLACE(salary, 0, ''), ''), '0') AS DECIMAL(18,6)) )
AS wrong_avg FROM employees ) 
SELECT CEILING(correct_avg - wrong_avg) FROM correct_cte, wrong_cte;
go

(4)
SELECT Name + '('+left(Occupation, 1)+')' AS First_Query
FROM Occupations
ORDER BY First_Query;

SELECT 'There are a total of '+cast(count(occupation) AS varchar)+' '+lower(Occupation)+'s.' from Occupations
Group by occupation
ORDER By count(occupation);
go

---------------------------------------------------------------------
1. Second highest salary in database ?

SELECT max(salary) as second_highest_salary
FROM Employees
WHERE salary < (SELECT MAX(salary) FROM Employees));

2. How do you get top 3 salaries per department ?
  SELECT empname, dept_id, salary
  FROM (
        SELECT empname, dept_id, salary
               DENSE_RANK() over(PARTITION BY dept_id ORDER BY Salary Desc) as rnnk
        FROM employees
   )t
  WHERE rnnk <=3;

3. How do you remove duplicates while keeping the earliest record ?
  DELETE FROM Employees
  WHERE emp_id NOT IN(SELECT MIN(emp_id) FROM Employees GROUP BY email)

4. How do u calculate running totals ?

5. How do you find customers who ordered for 3 consecutive days ?
   

6. How do you find employees earning more than the average salary of their department ?
   SELECT emp_name, salary 
   FROM Employees e
   WHERE Salary >
      (SELECT AVG(salary) FROM Employees 
       WHERE dept_id = e.dept_id) 

7.How do you identify managers who manage at least 5 employees ?
  SELECT manager_id, COUNT(*) as team_size
  FROM Employees
  GROUP BY manager_id
  HAVING COUNT(*) > =5;

8. How do you fetch the third transaction of each user ?

9. How do you compare each order amount with the previous order of the same user ?

10. How do you detect users who logged in every day for the last 7 days ?

References: 
https://www.youtube.com/post/UgkxjfM_z4ZnxuMQfSJfJsvD922HY6yKsW2b
Visionboard channel - InterviewQuestion 12/78


